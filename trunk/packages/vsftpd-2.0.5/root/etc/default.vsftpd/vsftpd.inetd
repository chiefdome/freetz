DAEMON=vsftpd

write_config() {
	(
		if [ -x "/tmp/flash/${DAEMON}_conf" ]; then
			/tmp/flash/${DAEMON}_conf
		else
			/mod/etc/default.$DAEMON/${DAEMON}_conf
		fi

		if [ -r "/tmp/flash/${DAEMON}.extra" ]; then
			cat /tmp/flash/${DAEMON}.extra
		fi
	) > /mod/etc/$DAEMON.conf
}

. /mod/etc/conf/vsftpd.cfg

write_config

inetdcfg_desc="vsftpd ftp server"
inetdcfg_port=$VFSTPD_PORT
inetdcfg_sock=stream
inetdcfg_proto=tcp
inetdcfg_flags=nowait
inetdcfg_user=root
inetdcfg_exe=/usr/sbin/vsftpd
inetdcfg_arg0=vsftpd
inetdcfg_args=""

