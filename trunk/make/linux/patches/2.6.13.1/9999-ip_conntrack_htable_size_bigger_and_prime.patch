--- linux-2.6.13.1/net/ipv4/netfilter/ip_conntrack_core.c
+++ linux-2.6.13.1/net/ipv4/netfilter/ip_conntrack_core.c
@@ -1136,9 +1136,11 @@
  	if (hashsize) {
  		ip_conntrack_htable_size = hashsize;
  	} else {
-		ip_conntrack_htable_size = 256;
+		/* according to http://www.netfilter.org/documentation/FAQ/netfilter-faq.html#toc3.7 */
+		/* an even hash bucket count (and esp. a value of power of two) is a bad choice      */
+		ip_conntrack_htable_size = 509; /* the 1s prime number less than 512 */
 	}
-	ip_conntrack_max = 8 * ip_conntrack_htable_size;
+	ip_conntrack_max = 4 * ip_conntrack_htable_size;
 
 	printk("ip_conntrack version %s (%u buckets, %d max)"
 	       " - %Zd bytes per conntrack\n", IP_CONNTRACK_VERSION,
